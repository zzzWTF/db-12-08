# Домашнее задание к занятию 12.8. «Резервное копирование баз данных» - Александр Гумлевой

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

Можно делать ежедневно полную копию базы, или делать полную копию раз в месяц и ежедневно делать инкрементные копии.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

Можно делать ежемесяно полную копию, еженедельную дифференциальную копию и почасовую инкриментную копию.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

Да, для этого можно настроить репликацию базы.

*Приведите ответ в свободной форме.*

---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).  
```shell  
pg_dump --dbname=testing(Имя_БД) --username=postgres(Имя_пользователя) --file=testing$(date +%Y-%m-%d-%T).dump(файл_для_копии)  
pg_restore testing.dump(файл_копии) --dbname=testing(Имя_БД_в_которую_восстанавливаем) --username=postgres(Имя_пользователя)
```  
2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

Да, можно написать bash скрипт для резервирования бд (создание копии, ее проверка, архивирование в нужную директорию) и добавить его в cron.

---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.  
```shell
mysqlbackup --defaults-file=/home/dbadmin/my.cnf \
  --incremental --incremental-base=history:last_backup \
  --backup-dir=/home/dbadmin/temp_dir \
  --backup-image=incremental_image1.bi \
   backup-to-image
```  
3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

Если к БД обращается достаточно большое количество пользователей, то репликация - лучший вариант, т.к. кроме поддержания постоянной резервной копии реплика может обслуживать часть запросов пользователей и, в случае выхода из строя master взять его роль на себя (в случае master-master репликации) или обслуживать запросы на чтение (в случае master-slave репликации).